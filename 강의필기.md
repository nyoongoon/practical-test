# 단위 테스트

- 작은 코드 단위(클래스 or 메서드)를 **독립적**으로 검증하는 테스트 (독립적->외부 의존하는 테스트가 아님)
- 테스트 기법 중 가장 작은 단위
- 검증 속도가 빠르고 안정적이다.

## JUnit

- 단위테스트를 위한 프레임워크

## AssertJ

- 테스트 라이브러리
- 풍부한 API, 메서드 체이닝 지원

# 테스트케이스 세분화하기

- 해피케이스, 예외케이스 -> 경계값 테스트가 중요

# 테스트하기 어려운 영역을 구분하고 분리하기

- 테스트코드 상에서 원하는 코드를 원하는 값을 넣어줄 수 있도록 설계를 변경하는 것이 중요하다.
- 외부로 분리할수록 테스트 가능한 코드는 많아진다..

```java
class Example {
    public Order createOrder(LocalDateTime currentDateTime) {
//        LocalDateTime currentDateTime = LocalDateTime.now();
        LocalTime currentTime = currentDateTime.toLocalTime();
        if (currentTime.isBefore(SHOP_OPEN_TIME) || currentTime.isAfter(SHOP_CLOSE_TIME)) {
            throw new IllegalArgumentException("주문 시간이 아닙니다. 관리자에게 문의하세요");
        }
        return new Order(currentDateTime, beverages);
    }
}
```

## 테스트하기 어려운 영역

- 관측할 때마다 다른값에 의존하는 코드 : 현재날짜, 시간, 랜덤값, 전역변수/함수, 사용자 입력 등
- 외부세계에 영향을 주는 코드 : 표준출력, 메시지 발송, DB기록 등..

## 테스트하기 쉬운 영역

- 순수함수 => 테스트하기 쉬운 함수
- -> 같은 입력에는 항상 같은 결과
- -> 외부 세상과 단절된 상태

## 단위테스트 키워드 정리

- 단위테스트
- 수동테스트, 자동화테스트
- Junit5, AssertJ
- 해피케이스, 예외케이스
- 경계값 테스트
- 테스트하기 쉬운영역(순수함수) / 어려운 영역
- cf) 롬복 -> @ToString은 순환참조문제 때문에 DTO에만 사용하는 편이다..

# TDD

- RED : 실패하는 테스트 작성
- GREEN : 테스트 통과 최소한의 코딩
- REFACTOR : 구현 코드 개선 테스트 통과 유지

## TDD 핵심가치 - 피드백

### 선기능 후 테스트 작성

- 테스트 누락 가능성
- 특정 케이스만 검증할 가능성 (해피케이스)
- 잘못된 구현을 다소 늦게 발견할 가능성

### 선테스트 후 기능 작성

- 복잡도가 낮은, 테스트 가능한 코드로 구현할 수 있게 한다
- 쉽게 발견하기 어려운 엣지 케이스를 놓치지 않게 해준다.
- 구현에 대한 빠른 피드백을 받을 수 있다.
- 과감한 리팩토링이 가능해진다.
### TDD - 관점의 변화
- 기존 테스트는 구현부 검증을 위한 보조 수단이었다면
- TDD는 테스트와 상호작용하며 발전하는 구현부..
- -> 클라이언트(내가 만든 객체를 사용하여 개발하는 입장) 관점에서 피드백을 주는 TDD

## TDD 키워드 정리
- TDD
- 레드-그린-리팩토링
cf)
- 애자일(vs폭포수)
- 익스트림 프로그래밍
- 스크럼, 칸반

# 테스트는 문서다 
- 프로덕션 기능을 설명하는 테스트 코드 문서
- 다양한 테스트 케이스를 통해 프로덕션 코드를 이해하는 시각과 관점 보완
- 모두의 자산으로 승격시킬 수 있다 

## DisplayName을 섬세하게
- 명사의 나열보단 문장으로 ('~~테스트' 지양) 
- A면 B이다
- A면 B가아니고 C이다 
- ex) 음료를 하나 추가하면 주문목록에 담긴다 -> 테스트 행위에 대한 결과까지 기술 
- ex) 특정시간이전에 주문을 생성하면 실패한다. -> '영업시작시간' 이전에는 주문을 생성할 수 없다. -> 도메인 용어를 사용하여 한층 추상화된 내용 담기
- -> 메서드 관점 자체보다 도메인 '정책' 관점으로!
- -> 테스트 현상을 중점으로 기술하지 말것(~하면 실패한다. -> 실패는 테스트의 현상이지 도메인 용어가 아니다)
- 
- 